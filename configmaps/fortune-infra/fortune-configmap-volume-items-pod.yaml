apiVersion: v1
kind: Pod
metadata:
  labels:
    app: fortune
  name: fortune-pod
spec:
  volumes:
    - name: html
      emptyDir: {}
    - name: config
      configMap:
        name: fortune-config
  containers:
  - image: nginx
    name: web-server
    ports:
      - containerPort: 80
        protocol: TCP
    volumeMounts:
      - name: html                           
        mountPath: /usr/share/nginx/html     
        readOnly: true
      - name: config
        mountPath: /etc/nginx/conf.d/
        #subPath: my-nginx-config.conf
        readOnly: true

  - image: anandaili/fortune:env
    name: html-generator
    env:
      - name: INTERVAL
        valueFrom:
          configMapKeyRef:
            name: fortune-config
            key: sleep-interval
    volumeMounts:
      - name: html 
        mountPath: /var/htdocs 
       
    
